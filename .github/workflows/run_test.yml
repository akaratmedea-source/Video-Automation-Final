name: Run Notebook via Python (Stable Method)

on:
  workflow_dispatch:

jobs:
  run-notebook:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Set up Python Environment
      uses: actions/setup-python@v5
      with:
        python-version: '3.x'

    - name: Install required dependencies
      run: |
        # ุชุซุจูุช ุงูุฃุฏูุงุช ุงููุงุฒูุฉ ูุชุญููู ูุชูููุฐ ุฏูุงุชุฑ Jupyter/Colab
        pip install jupyter nbformat nbconvert google-colab

    # ๐ ุฎุทูุฉ ุงููุตุงุฏูุฉ ุงูุขููุฉ: ูุชุงุจุฉ ุงูููุชุงุญ ุงูุณุฑู ูู ููู ูุคูุช (key.json)
    - name: Prepare Service Account Key File
      run: |
        echo '${{ secrets.GOOGLE_CREDS }}' > key.json

    # ๐ ุฎุทูุฉ ุงูุชูููุฐ ุงูุญุงุณูุฉ: ุชุญููู ุงูููู ูุชุดุบููู ูุณูุฑูุจุช Python ุนุงุฏู
    - name: Execute Notebook as Python Script
      run: |
        # 1. ุชุญููู ููู .ipynb ุฅูู ููู python ุนุงุฏู .py
        jupyter nbconvert --to python test_automation.ipynb
        # 2. ุชุดุบูู ุงูููู ุงููุงุชุฌ. ุณูุณุชุฎุฏู key.json ุชููุงุฆูุงู ูููุตุงุฏูุฉ.
        python test_automation.py
